These codes are from https://github.com/malfante/AAA with few modification that still need to be specified.
